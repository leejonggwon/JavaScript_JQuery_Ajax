<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

    <div id="movie-list"></div>
    <br>

    <button id= "req-btn">영화정보출력하기</button>
    
    <script src="./js/jquery-3.7.1.js"></script>
    <script>
        //Ajax(비동기통신)
        // - 화면의 갱신없이 서버에 요청을 보내는 통신 방식

        let getMovieData = function(){
            let movieURL="https://kobis.or.kr/kobisopenapi/webservice/rest/boxoffice/searchDailyBoxOfficeList.json?key=aa93189e2e78a5874c636d8a0e3fc193&targetDt=20250818";
            
            //Ajax함수 사용하는 방법
            //url: 요청을 보낼 주소  
            $.ajax({
                url:movieURL,

                success:function(res){ //서버에서 받아온 데이터를 사용하려면, 매개변수(parameter)를 설정해야 한다, 이렇게 하면 받아온 데이터가 함수 안에서 매개변수로 사용 가능해진다.
                    //요청이 성공했을 때 살행할 로직 구현
                    //서버에서 보내주는 데이터를 받아올 때 function()에 매개변수를 지정해줘야 한다
    
                    //순차적으로 키접근
                    // console.log(res);
                    // console.log(res.boxOfficeResult);
                    //console.log(res.boxOfficeResult.dailyBoxOfficeList);

                    let movieList = res.boxOfficeResult.dailyBoxOfficeList; //20250818 영화리스트
                    
                    //영화정보를 table태그로 그려주는 함수 호출(함수로 분리)
                    drawTable(movieList);

                },
                error:function(){
                    //요청이 실패했을 때 실행할 로직 구현 
                    alert("요청실패");
                }
            });
        }

        let drawTable = function(movieList){
            let resultHTML = 
                        `<table border="1">
                            <tr>
                                <th>순위</th>
                                <th>영화명</th>
                                <th>개봉일</th>
                            </tr>
                        `;
   
            //영화이름(movieNm), 개봉일(openDt), 순위(rank)
            for (let i = 0; i < movieList.length; i++) {
                //console.log(movieList[i].rank, movieList[i].movieNm, movieList[i].openDt); 
                resultHTML +=  `
                    <tr>
                        <td>${movieList[i].rank}</td>
                        <td>${movieList[i].movieNm}</td>
                        <td>${movieList[i].openDt}</td>
                    </tr>
                `;
            }

            resultHTML += `</table>`;

            //id가 "movie-list"인 div태그에 resultHTML값을 저장 → 웹 페이지에 출력이 된다는 의미
            $("#movie-list").html(resultHTML); 
        }

        //버튼을 클릭했을 때 영화정보 가져오기 
        $("#req-btn").on("click", getMovieData);
        

    </script>
</body>
</html>




















